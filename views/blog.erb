<%require 'date'

def days_in_month(year, month)
  Date.new(year, month, -1).day
end 

year = Time.now.year

@month_names = {
	"January" => 1, "February" => 2, "March" => 3, 
	"April" => 4, "May" => 5, "June" => 6,
	"July" => 7, "August" => 8, "September" => 9,
	"October" => 10, "November" => 11, "December" => 12
}
@day_names = [
	"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"
]
%> 

<% @month_names.each do |month_name| %>
	<table border="1" align="center">
	  <thead>
	    <tr>
	      <th colspan="7"><%= month_name[0] %></th>
	    </tr>
	    <tr>
	    	<% @day_names.each do |day| %>
	      	<th><%= day %></th>
	      <% end %> 
	    </tr>
	  </thead>


	<% first_day = Time.mktime(year, month_name[1], 1).strftime("%a") 
			@day_count = 0
			case first_day
			when "Mon" 
				1.times do %> 
					<td></td>
					<% @day_count += 1 %>
				<% end %>
			<% when "Tue" 
				2.times do %>
					<td></td>
					<% @day_count += 1 %>
				<% end %>
			<% when "Wed" 
				3.times do %>
					<td></td>
					<% @day_count += 1 %>
				<% end %>
			<% when "Thu" 
				4.times do %>
					<td></td>
					<% @day_count += 1 %>
				<% end %>
			<% when "Fri" 
				5.times do %>
					<td></td>
					<% @day_count += 1 %>
				<% end %>
			<% when "Sat" 
				6.times do %>
					<td></td>
					<% @day_count += 1 %>
				<% end %>
			<% end %>

	<% if @day_count % 7 == 0 %>
		<tr colspan="7">
	<%end %>
			<% (1..days_in_month(year, month_name[1])).each do |num| %>
				<td><%= num %></td>
				<% @day_count += 1 %> 
				<% if @day_count % 7 == 0 %> 
					</tr><tr colspan="7">
				<% end %> 
			<% end %> 
		</tr>
	</table>
<% end %>